# Введение в PyTest
Pytest - современная библиотека тестирования python кода, предоставляющая удобный и быстрый в написании функционал тестирования программ любого уровня сложности. 

###  Почему в проекте решено использовать PyTest

1. Простота установки и начала работы
2. Минимальный код при максимальной функциональности
3. Наличие функционала параметризации 
4. Автоматическое обнаружение написанных тестов без необходимости писать дополнительное ПО для запуска 
5. Возможность использования фикстур
***

### Простота установки и начала работы

Для начала работы с библиотекой достаточно установить модуль pytest и подключить библиотеку в код.

```python
import pytest
```
***

### Минимальный код при максимальной функциональности

Представим простой пример сравнения тестирования функции через PyTest и GTest


PyTest:

```python
def add(a, b):
    return a + b

def test_add():
    assert add(2, 2) == 4
    assert add(-1, 1) == 0
    assert add(-1, -1) == -2
```

GTest:

```python
import unittest

def add(a, b):
    return a + b

class TestAddFunction(unittest.TestCase):
    def test_add(self):
        self.assertEqual(add(2, 2), 4)
        self.assertEqual(add(-1, 1), 0)
        self.assertEqual(add(-1, -1), -2)

if __name__ == '__main__':
    unittest.main()
```

PyTest требует значительно меньше кода для достижения той же функциональности.

Также отметим, что для PyTest нет необходимости вызывать написанные тесты, т.к. они автоматически определяются и вызываются программой.
***

###  Основной используемый функционал

Помимо базового примера проверки, представленного выше, существуют ещё три немаловажных аспекта библиотеки PyTest.

1. **Параметризация теста**

```python
@pytest.mark.parametrize("input,expected", [
    ("hello", 5),
    ("world", 5),
    ("pytest", 6)
])
def test_length(input, expected):
    assert len(input) == expected
```

Данная технология позволяет запускать один и тот же тест с разными наборами данных, уменьшая дублирование кода и увеличивая покрытие тестами (т.е. нет необходимости писать множество маленьких тестов или строк с assert).

2. **Фикстуры**

Фикстуры в PyTest - это готовые данные или объекты, которые можно переиспользовать в разных тестах. Они помогают избежать дублирования кода и делают тесты более эффективными.

```python
@pytest.fixture
def numbers():
    return [1, 2, 3]

def test_length(numbers):
    assert len(numbers) == 3

def test_sum(numbers):
    assert sum(numbers) == 6
```

Данный пример создает список чисел один раз с помощью фикстуры и использует его в обоих тестах (таже фикстура позволяет не делать обычный вызов функции). 

Фикстура предпочтительна, когда:

* Нужны одни и те же данные в нескольких тестах
* Подготовка данных требует много времени или ресурсов

Данная технология часто используется в крупных проектах.

3. **Тестирование исключений**

Тестирование исключений позволяет проверять, что код правильно обрабатывает ошибки и исключения, делая приложение более надёжным.

```python
def divide(a, b):
    if b == 0:
        raise ZeroDivisionError("Нельзя делить на ноль!")
    return a / b

def test_division_by_zero():
    with pytest.raises(ZeroDivisionError):
        divide(10, 0)
```

В данном примере:

* Функция divide вызывает ошибку при делении на ноль
* Тест проверяет, что ошибка действительно возникает
* Если ошибка не возникнет - тест упадёт

При подобном тестировании мы также можем ожидать от программы конкретное поведение и вывод.

```python
def test_division_by_zero_with_message():
    with pytest.raises(ZeroDivisionError) as e:
        divide(10, 0)
    assert str(e.value) == "Нельзя делить на ноль!"
```

В данном случае проверяется не только наличии ошибки, но и возвращаемый текст.

### Итог

Pytest значительно упрощает процесс тестирования благодаря своей гибкости и богатому функционалу, особенно в части работы с данными и параметризации тестов. Библиотека предоставляет все необходимые инструменты для эффективного написания и выполнения юнит-тестов, что делает её препдочтительным выбором в нашем проекте.